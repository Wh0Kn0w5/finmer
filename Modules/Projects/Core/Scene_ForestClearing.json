{
	"!Type": "AssetScene",
	"ID": "8bd05185-f23d-43ac-bb88-300df2b54acc",
	"Name": "Scene_ForestClearing",
	"ScriptCustom": {
		"ID": "9af934a4-2810-46b0-be9f-4a7e1ee1b3c3",
		"Name": "Scene_ForestClearing_CustomScript"
	},
	"ScriptEnter": {
		"ID": "5aec94ec-a624-4419-82ec-ae69bfae3130",
		"Name": "Scene_ForestClearing_OnEnter"
	},
	"ScriptLeave": {
		"ID": "696c79fc-ffce-4696-9910-400ed64a67e7",
		"Name": "Scene_ForestClearing_OnLeave"
	},
	"IsPatch": false,
	"Root": {
		"Key": "Root",
		"IsState": false,
		"IsLink": false,
		"Title": "Root",
		"Tooltip": "",
		"Highlight": false,
		"ButtonWidth": 1.0,
		"ScriptAction": "",
		"ScriptAppear": "",
		"Children": [
			{
				"Key": "SavePoint_Clearing",
				"IsState": true,
				"IsLink": false,
				"ScriptAction": "Log(\"FOREST_CLEARING_SAVEPOINT\")\r\nStorage.SetFlag(\"savepoint\", false)",
				"ScriptAppear": "return Storage.GetFlag(\"savepoint\")",
				"Children": [
					{
						"Key": "AutoLink",
						"IsState": false,
						"IsLink": true,
						"Title": "",
						"Tooltip": "",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"LinkTarget": "Clearing_C_Leave",
						"Children": []
					}
				]
			},
			{
				"Key": "Abandoned",
				"IsState": true,
				"IsLink": false,
				"ScriptAction": "LogGsub(\"SQ02_ABANDONED\", {sun = GetIsNight() and \"moon\" or \"sun\"})\r\n\r\n-- temporary global variable\r\ncanSleep = true",
				"ScriptAppear": "return Storage.GetNumber(\"sq02\") ~= 1",
				"Children": [
					{
						"Key": "Clearing_C_Camp",
						"IsState": false,
						"IsLink": false,
						"Title": "Rest",
						"Tooltip": "This looks like a decent spot to set up camp.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": "",
						"ScriptAppear": "",
						"Children": [
							{
								"Key": "Clearing_R_Camp",
								"IsState": true,
								"IsLink": false,
								"ScriptAction": "",
								"ScriptAppear": "",
								"Children": [
									{
										"Key": "Clearing_C_Sleep",
										"IsState": false,
										"IsLink": false,
										"Title": "Sleep",
										"Tooltip": "Sit a moment and rest.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "return canSleep",
										"Children": [
											{
												"Key": "Clearing_R_Sleep",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "Log(\"forest_sleep\")\r\ncanSleep = false\r\nRest()\r\nLog(\"forest_sleep_wakeup\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "Clearing_C_SleepDone",
														"IsState": false,
														"IsLink": false,
														"Title": "Continue",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": "",
														"ScriptAppear": "",
														"Children": [
															{
																"Key": "AutoLink",
																"IsState": true,
																"IsLink": true,
																"LinkTarget": "Clearing_R_Camp",
																"Children": []
															}
														]
													}
												]
											}
										]
									},
									{
										"Key": "Clearing_C_Save",
										"IsState": false,
										"IsLink": false,
										"Title": "Save",
										"Tooltip": "Record your adventure so far.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "Storage.SetFlag(\"savepoint\", true)\r\nSaveData.ShowSaveDialog()\r\nStorage.SetFlag(\"savepoint\", false)",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "AutoLink",
												"IsState": true,
												"IsLink": true,
												"LinkTarget": "Clearing_R_Camp",
												"Children": []
											}
										]
									},
									{
										"Key": "AutoLink",
										"IsState": false,
										"IsLink": true,
										"Title": "",
										"Tooltip": "",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"LinkTarget": "Clearing_C_Leave",
										"Children": []
									}
								]
							}
						]
					},
					{
						"Key": "Clearing_C_Leave",
						"IsState": false,
						"IsLink": false,
						"Title": "Leave",
						"Tooltip": "Leave this clearing behind.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": "",
						"ScriptAppear": "",
						"Children": [
							{
								"Key": "Clearing_R_Leave",
								"IsState": true,
								"IsLink": false,
								"ScriptAction": "SetScene(\"Scene_Forest\")",
								"ScriptAppear": "",
								"Children": []
							}
						]
					}
				]
			},
			{
				"Key": "SQ02_Start",
				"IsState": true,
				"IsLink": false,
				"ScriptAction": "LogGsub(\"SQ02_OPENING\", {sun = GetIsNight() and \"sun\" or \"moon\"})",
				"ScriptAppear": "",
				"Children": [
					{
						"Key": "SQ02_C_Approach",
						"IsState": false,
						"IsLink": false,
						"Title": "Approach",
						"Tooltip": "Walk forward confidently.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": "",
						"ScriptAppear": "",
						"Children": [
							{
								"Key": "SQ02_R_Approach",
								"IsState": true,
								"IsLink": false,
								"ScriptAction": "Log(\"SQ02_APPROACH\")",
								"ScriptAppear": "",
								"Children": [
									{
										"Key": "SQ02_C_ApproachAgain",
										"IsState": false,
										"IsLink": false,
										"Title": "Approach",
										"Tooltip": "Get a bit closer still.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "SQ02_R_ApproachAgain",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "Log(\"SQ02_APPROACH_AGAIN\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "SQ02_C_DoCombatOV",
														"IsState": false,
														"IsLink": false,
														"Title": "Uh-oh...",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": "Storage.SetFlag(\"forest_direwolf_fought\", true)\r\n\r\nlocal wuff = Creature(\"SQ02_Wolf_OV\")\r\nCombat.AddCombatant(wuff)\r\nCombat.OnPlayerKilled(function()\r\n    EatThePlayerAnyway(wuff)\r\n    PostVore(\"SQ02_WOLF_POSTVORE_SCAT\", \"SQ02_WOLF_POSTVORE\")\r\nend)\r\nCombat.OnPlayerDigested(function()\r\n    PostVore(\"SQ02_WOLF_POSTVORE_SCAT\", \"SQ02_WOLF_POSTVORE\")\r\nend)\r\nCombat.Begin()",
														"ScriptAppear": "",
														"Children": [
															{
																"Key": "AutoLink",
																"IsState": true,
																"IsLink": true,
																"LinkTarget": "SQ02_R_Slay",
																"Children": []
															}
														]
													}
												]
											}
										]
									},
									{
										"Key": "SQ02_C_ApproachStop",
										"IsState": false,
										"IsLink": false,
										"Title": "Stop",
										"Tooltip": "Freeze right where you are, and try to not look threatening.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "SQ02_R_ApproachStop",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "Log(\"SQ02_APPROACH_STOP\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "SQ02_C_OfferSelf",
														"IsState": false,
														"IsLink": false,
														"Title": "Offer self",
														"Tooltip": "Gently reach out and pry apart the canine's lips.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": "",
														"ScriptAppear": "",
														"Children": [
															{
																"Key": "SQ02_R_OfferSelf",
																"IsState": true,
																"IsLink": false,
																"ScriptAction": "-- first play a sequence showing the vore happening\r\nLog(\"SQ02_WOLF_VORE_WILLING\")\r\nlocal wuff = Creature(\"SQ02_Wolf_OV\")\r\nLogRaw(wuff:GetString(\"vore_hit_pov\"))\r\nLogRaw(wuff:GetString(\"vore_win_pov\"))\r\n\r\n-- then use combat system for digestion.\r\n-- note: player is not expected to survive this, so no more nodes come after this one\r\nCombat.AddCombatant(wuff)\r\nCombat.SetVored(wuff, Player, true)\r\nCombat.OnPlayerDigested(function()\r\n    PostVore(\"SQ02_WOLF_POSTVORE_SCAT\", \"SQ02_WOLF_POSTVORE\")\r\nend)\r\nCombat.Begin()",
																"ScriptAppear": "",
																"Children": []
															}
														]
													},
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_OfferFish",
														"Children": []
													},
													{
														"Key": "SQ02_C_Bellyrub",
														"IsState": false,
														"IsLink": false,
														"Title": "Bellyrub",
														"Tooltip": "Well, you got this close, what else did you want to do?",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"ScriptAction": "",
														"ScriptAppear": "",
														"Children": [
															{
																"Key": "SQ02_R_Bellyrub",
																"IsState": true,
																"IsLink": false,
																"ScriptAction": "Log(\"SQ02_BELLYRUB\")",
																"ScriptAppear": "",
																"Children": [
																	{
																		"Key": "SQ02_C_EndoAccept",
																		"IsState": false,
																		"IsLink": false,
																		"Title": "Accept",
																		"Tooltip": "Place your paws on the inviting-looking tongue.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAction": "",
																		"ScriptAppear": "",
																		"Children": [
																			{
																				"Key": "SQ02_R_EatPlayerSafe",
																				"IsState": true,
																				"IsLink": false,
																				"ScriptAction": "Storage.SetFlag(\"forest_direwolf_friendly\", true)\r\nStorage.SetNumber(\"sq02\", 3) -- disable clearing event\r\n\r\nlocal wuff = Creature(\"CR_SQ02_Wolf_OV\")\r\nwuff.PredatorDigests = false -- enable endo mode\r\n\r\n-- willing endo vore sequence\r\nLog(\"SQ02_WOLF_VORE_HIT_POV\")\r\nLog(\"SQ02_WOLF_ENDO_VORE_WIN_POV\")\r\nText.SetContext(\"predator\", wuff)\r\n\r\nlocal state = Combat2()\r\nstate:AddParticipant(Player)\r\nstate:AddParticipant(wuff)\r\nstate:SetVored(wuff, Player)\r\nstate:OnRoundEnd(function(round)\r\n    if round >= 5 then\r\n        state:End()\r\n    end\r\nend)\r\nstate:Begin()\r\n\r\n-- after combat ends\r\nSetScene(\"Scene_DireWolf_Stomach\")",
																				"ScriptAppear": "",
																				"Children": []
																			}
																		]
																	},
																	{
																		"Key": "SQ02_R_EndoRun",
																		"IsState": false,
																		"IsLink": false,
																		"Title": "Back away",
																		"Tooltip": "Get away from this dangerous predator.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAction": "Log(\"SQ02_WOLF_ENDO_RUNAWAY\")",
																		"ScriptAppear": "",
																		"Children": [
																			{
																				"Key": "AutoLink",
																				"IsState": true,
																				"IsLink": true,
																				"LinkTarget": "SQ02_R_EatPlayerSafe",
																				"Children": []
																			}
																		]
																	}
																]
															}
														]
													}
												]
											}
										]
									},
									{
										"Key": "SQ02_C_ApproachBack",
										"IsState": false,
										"IsLink": false,
										"Title": "Back away",
										"Tooltip": "Slowly back away from the dire wolf.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "SQ02_R_ApproachBack",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "Log(\"SQ02_APPROACH_BACK\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_DoCombatOV",
														"Children": []
													}
												]
											}
										]
									},
									{
										"Key": "SQ02_C_OfferFish",
										"IsState": false,
										"IsLink": false,
										"Title": "Offer fish",
										"Tooltip": "The wolf appears to have caught on to the scent.",
										"Highlight": true,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "return Player:HasItem(\"U_FoodFish1Raw\") or Player:HasItem(\"U_FoodFish1Cooked\")",
										"Children": [
											{
												"Key": "SQ02_R_OfferFish",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "if Player:HasItem(\"U_FoodFish1Raw\") then\r\n    Player:TakeItem(\"U_FoodFish1Raw\")\r\nelse\r\n    Player:TakeItem(\"U_FoodFish1Cooked\")\r\nend\r\n\r\nLog(\"SQ02_OFFER_FISH\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_EndoAccept",
														"Children": []
													},
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_R_EndoRun",
														"Children": []
													}
												]
											}
										]
									}
								]
							}
						]
					},
					{
						"Key": "SQ02_C_SneakCloser",
						"IsState": false,
						"IsLink": false,
						"Title": "Sneak closer",
						"Tooltip": "[Wits] Try to approach without being detected.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": "",
						"ScriptAppear": "",
						"Children": [
							{
								"Key": "SQ02_R_SneakFail",
								"IsState": true,
								"IsLink": false,
								"ScriptAction": "Log(\"SQ02_SNEAK_FAIL\")",
								"ScriptAppear": "return Player.Wits <= 2",
								"Children": [
									{
										"Key": "AutoLink",
										"IsState": false,
										"IsLink": true,
										"Title": "",
										"Tooltip": "",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"LinkTarget": "SQ02_C_ApproachAgain",
										"Children": []
									},
									{
										"Key": "AutoLink",
										"IsState": false,
										"IsLink": true,
										"Title": "",
										"Tooltip": "",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"LinkTarget": "SQ02_C_ApproachStop",
										"Children": []
									},
									{
										"Key": "AutoLink",
										"IsState": false,
										"IsLink": true,
										"Title": "",
										"Tooltip": "",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"LinkTarget": "SQ02_C_ApproachBack",
										"Children": []
									},
									{
										"Key": "AutoLink",
										"IsState": false,
										"IsLink": true,
										"Title": "",
										"Tooltip": "",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"LinkTarget": "SQ02_C_OfferFish",
										"Children": []
									}
								]
							},
							{
								"Key": "SQ02_R_SneakCloser",
								"IsState": true,
								"IsLink": false,
								"ScriptAction": "Log(\"SQ02_SNEAK_OK\")",
								"ScriptAppear": "",
								"Children": [
									{
										"Key": "SQ02_C_Slay",
										"IsState": false,
										"IsLink": false,
										"Title": "Slay",
										"Tooltip": "A clean cut should do it. However grim, the townsfolk would probably appreciate it.",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "SQ02_R_Slay_NoWep",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "LogGsub(\"SQ02_SNEAK_SLAY_NOWEAPON\", {claws = Player.NaturalWeapon.Alias})",
												"ScriptAppear": "local t = Player.PrimaryWeapon.WeaponType\r\nreturn t == WeaponType.Natural",
												"Children": [
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_Slay",
														"Children": []
													},
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_SneakBellyrub",
														"Children": []
													}
												]
											},
											{
												"Key": "SQ02_R_Slay",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "LogGsub(\"SQ02_SNEAK_SLAY_OK\", {weapon = Player.PrimaryWeapon.Alias})\r\nStorage.SetNumber(\"sq02\", 2) -- can't visit this sequence again\r\n\r\nJournal.Update(\"SQ02\", 20)\r\nPlayer:GiveItem(\"SQ02_WolfHead\", true)\r\n\r\n-- stealth?\r\nif not Storage.GetFlag(\"forest_direwolf_fought\") then\r\n    Player:AwardXP(RewardXP.SQ02_StealthSlay)\r\nend",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "Clearing_C_Leave",
														"Children": []
													}
												]
											}
										]
									},
									{
										"Key": "SQ02_C_SneakBellyrub",
										"IsState": false,
										"IsLink": false,
										"Title": "Bellyrub",
										"Tooltip": "Well, you got this close, what else did you want to do?",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"ScriptAction": "",
										"ScriptAppear": "",
										"Children": [
											{
												"Key": "SQ02_R_SneakBellyrub",
												"IsState": true,
												"IsLink": false,
												"ScriptAction": "Log(\"SQ02_BELLYRUB_SNEAK\")",
												"ScriptAppear": "",
												"Children": [
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_C_EndoAccept",
														"Children": []
													},
													{
														"Key": "AutoLink",
														"IsState": false,
														"IsLink": true,
														"Title": "",
														"Tooltip": "",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"LinkTarget": "SQ02_R_EndoRun",
														"Children": []
													}
												]
											}
										]
									}
								]
							}
						]
					},
					{
						"Key": "SQ02_C_SneakAway",
						"IsState": false,
						"IsLink": false,
						"Title": "Sneak away",
						"Tooltip": "[Wits] Try to get away again without being noticed.",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": "",
						"ScriptAppear": "",
						"Children": [
							{
								"Key": "AutoLink",
								"IsState": true,
								"IsLink": true,
								"LinkTarget": "SQ02_R_SneakFail",
								"Children": []
							}
						]
					}
				]
			}
		]
	}
}